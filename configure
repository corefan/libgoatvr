#!/bin/sh

prefix=/usr/local
opt=false
dbg=true
use_libovr=true
use_openhmd=false	# not done

while [ $# != 0 ]; do
	case $1 in
	--prefix=*)
		value=`echo $arg | sed 's/--prefix=//'`
		prefix=${value:-$prefix}
		;;

	--enable-libovr)
		use_libovr=true
		;;
	--disable-libovr)
		use_libovr=false
		;;

	--enable-openhmd)
		use_openhmd=true
		;;
	--disable-openhmd)
		use_openhmd=false
		;;

	--enable-opt)
		opt=true
		;;
	--disable-opt)
		opt=false
		;;
	--enable-debug)
		dbg=true
		;;
	--disable-debug)
		dbg=false
		;;

	--help)
		echo 'options:'
		echo '--prefix=<path>: installation path (default: /usr/local)'
		echo '--enable-libovr: enable the Oculus SDK VR module (default)'
		echo '--disable-libovr: disable the Oculus SDK VR module'
		echo '--enable-openhmd: enable the OpenHMD VR module (default)'
		echo '--disable-openhmd: disable the OpenHMD VR module'
		echo '--enable-opt: enable optimizations'
		echo '--disable-opt: disable optimizations'
		echo '--enable-debug: enable debugging symbols (default)'
		echo '--disable-debug: disable debugging symbols'
		exit 0
		;;
	esac
	shift
done

echo 'Configuring libgoatvr...'
echo "  install prefix: $prefix"
echo '  optimizations: ' `$opt && echo yes || echo no`
echo '  debug symbols: ' `$opt && echo yes || echo no`
echo '  use Oculus SDK (LibOVR): ' `$use_libovr && echo yes || echo no`
echo '  use OpenHMD: ' `$use_openhmd && echo yes || echo no`

echo '# generated makefile, do not edit' >Makefile
echo "PREFIX = $prefix" >>Makefile
if $opt; then
	echo 'opt = -O3' >>Makefile
fi
if $dbg; then
	echo 'dbg = -g' >>Makefile
fi
if $use_libovr; then
	echo 'use_libovr = 1' >>Makefile
fi
if $use_openhmd; then
	echo 'use_openhmd = 1' >>Makefile
fi
echo '# ----------------' >>Makefile

cat Makefile.in >>Makefile
